# 그래프 컨볼루션 레이어 vs 그래프 선형 레이어

![001](WEEK02/preview/img/001.png)

## 그래프 컨볼루션 레이어 설계하기

- **문제:**  
  노드는 항상 같은 수의 이웃을 가지고 있지 않음.  
  예: 노드 A는 1000개의 이웃, 노드 B는 1개의 이웃 → 임베딩 값의 차이가 커져 의미 있는 비교가 어려움.

- **해결책:**  
  이웃 수로 임베딩 값을 나누어 정규화.

---

## 수식 및 구성 요소

- 행렬 연산:  
  \( H = D^{-1} A X W \)

- 정규화 상수:  
  차수 행렬 \( D \) 의 역행렬에서 얻음.

- 자가 순환 추가:  
  \( A \leftarrow A + I \)

- 정규화 행렬 선택:  
  - \( D^{-1} A \) (모든 행 정규화)
  - \( A D^{-1} \) (모든 열 정규화)

- Kipf & Welling 하이브리드 정규화:  
  이웃이 적은 노드에 더 높은 가중치를 부여.

---

![002](WEEK02/preview/img/002.png)

## 그래프 컨볼루션 vs 그래프 선형 비교 실험

- **데이터셋:**  
  - Cora (노드 이웃: 1~168개)  
  - Facebook Page-Page (노드 이웃: 1~709개)

- **분석:**  
  노드 차수의 넓은 범위가 GCN 성능에 영향.

- **구현:**  
  PyTorch Geometric `GCNConv` 레이어 사용.

- **결과:**  
  - Cora: 정확도 80.17% (±0.61%)  
  - Facebook Page-Page: 정확도 91.54% (±0.28%)

  → 노드 차수 범위가 넓을수록 GCN 성능이 더 잘 나옴.
  
![002](WEEK02/preview/img/002.png)

## 그래프 컨볼루션 vs 그래프 선형 비교 실험

- **그래프 컨볼루션 레이어와 그래프 선형 레이어 비교**

- **데이터셋:**  
  Cora와 Facebook Page-Page 데이터셋 사용

- **노드 차수 분석:**  
  - Cora 데이터셋: 1~168개의 이웃을 가진 노드 존재  
  - Facebook Page-Page 데이터셋: 1~709개의 이웃을 가진 노드 존재  
  → 노드 차수의 넓은 범위는 GCN의 성능에 영향을 미침

- **PyTorch Geometric 사용:**  
  `GCNConv` 레이어를 사용하여 GCN 구현

- **정확도 측정:**  
  accuracy를 사용하여 성능 비교

- **결과:**  
  - Cora: 80.17% (±0.61%) 정확도  
  - Facebook Page-Page: 91.54% (±0.28%) 정확도  
  → 노드 차수 범위가 넓을수록 GCN의 성능이 더욱 향상됨을 확인
